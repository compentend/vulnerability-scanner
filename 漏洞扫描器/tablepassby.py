import requests
from bs4 import BeautifulSoup


def check_form_bypass(url):
    try:
        # 发送GET请求获取页面内容
        response = requests.get(url)

        # 使用BeautifulSoup解析HTML
        soup = BeautifulSoup(response.text, 'html.parser')

        # 查找页面上的表单
        forms = soup.find_all('form')

        # 遍历每个表单
        for form in forms:
            # 获取表单的action属性
            action = form.get('action')

            # 如果action属性为空,则可能存在表单绕过漏洞
            if not action:
                print(f"[!] 表单绕过漏洞可能存在于 {url}")
                return True
    except requests.exceptions.RequestException as e:
        print(f"[!] 检测过程中出现错误: {e}")

    # 如果没有发现表单绕过漏洞,返回False
    return False

def text():
    print("尝试调用")


# 测试URL
url = "http://127.0.0.1/pikachu/vul/burteforce/bf_server.php"
if check_form_bypass(url):
    print("存在表单绕过漏洞")
else:
    print("不存在表单绕过漏洞")
