#!usr/bin/env python
import self

import scanner
import tablepassby

#target_url = "http://zero.webappsecurity.com/"
target_url = "http://127.0.0.1/pikachu/vul/burteforce/bf_form.php"#暴力破解漏洞
#target_url = "http://127.0.0.1/pikachu/vul/burteforce/bf_server.php"#表单绕过漏洞
#target_url = "http://127.0.0.1/pikachu/vul/xss/xss_reflected_get.php"#XSS漏洞http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=&submit=%E6%8F%90%E4%BA%A4
#target_url = "http://127.0.0.1/pikachu/vul/csrf/csrfget/csrf_get_login.php"#CSRF漏洞
#target_url = "http://127.0.0.1/pikachu/vul/sqli/sqli_str.php"#SQL注入漏洞
#target_url = "http://127.0.0.1/pikachu/vul/fileinclude/fi_local.php?filename=&submit=%E6%8F%90%E4%BA%A4"#文件包含漏洞
ignore_links = ["http://10.0.2.17/dvwa/logout.php"]
data_dict = {"user_login" : "username" , "user_password" : "password" , "name" : "submit"}

vuln_scan = scanner.Scanner(target_url , ignore_links)
print('test')
vuln_scan.session.post("http://zero.webappsecurity.com/login.html", data=data_dict)
print('success')


# def vuln_scan(target_url):
#     vuln_scan.scanner.crawl(target_url)
#     print("for test")


# vuln_scan(target_url)

vuln_scan.crawl(target_url)
vuln_scan.p()
# vuln_scan.run_scanner()
# vuln_scan.sqli_scanner()
# vuln_scan.brute_force_scanner()
# vuln_scan.form_bypass_scanner()
# vuln_scan.csrf_scanner()
#vuln_scan.file_inclusion_scanner()
